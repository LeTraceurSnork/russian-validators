<?php

namespace LTS\RussianValidators\Tests;

use LTS\RussianValidators\KsValidator;

/**
 * @coversDefaultClass \LTS\RussianValidators\KsValidator
 */
class KsValidatorTest extends AbstractGeneralValidatorTest
{
    /**
     * KS by BIK Validator
     *
     * @var KsValidator
     */
    private static KsValidator $by_bik_validator;

    /**
     * @return void
     */
    public static function setUpBeforeClass(): void
    {
        self::$validator        = new KsValidator();
        self::$by_bik_validator = new KsValidator();
    }

    /**
     * @dataProvider validKsWithBikDataProvider
     *
     * @param $ks
     * @param $bik
     *
     * @return void
     */
    public function testValidKsByBik($ks, $bik): void
    {
        $this->assertTrue(self::$by_bik_validator->byBik($bik)->validate($ks));
    }

    /**
     * @dataProvider invalidKsWithBikDataProvider
     *
     * @param $ks
     * @param $bik
     *
     * @return void
     */
    public function testInvalidKsByBik($ks, $bik): void
    {
        $this->assertFalse(self::$by_bik_validator->byBik($bik)->validate($ks));
    }

    /**
     * @inheritDoc
     */
    protected function validDataProvider(): array
    {
        return [
            ['30109625373068343090'],
            ['30110324659154312121'],
            ['30109323304057490630'],
            ['30110547501266828484'],
            ['30110486374115245670'],
            ['30110912552628796997'],
            ['30109120222403983426'],
            ['30110150779637430687'],
            ['30109603968393231840'],
            ['30110253911649555301'],
            ['30110657614673706258'],
            ['30109215579320352429'],
            ['30109506153640892107'],
            ['30109259682308310834'],
            ['30109676502705205603'],
            ['30110143804814899087'],
            ['30110094882274059236'],
            ['30110336168641080514'],
            ['30109968670614413463'],
            ['30110926664608376666'],
            ['30110354309386888871'],
            ['30110706512016938577'],
            ['30109992739088987801'],
            ['30110335030457274337'],
            ['30109708017918837402'],
            ['30110218745421106391'],
            ['30110017365405537660'],
            ['30110164570366106114'],
            ['30110967705171336456'],
            ['30110754068042272388'],
            ['30110771388301196820'],
            ['30109183991954975317'],
            ['30109059108391952851'],
            ['30110287548488424605'],
            ['30109258809007919446'],
            ['30109506102048592854'],
            ['30109469324548574662'],
            ['30110372317567669097'],
            ['30110345961987875135'],
            ['30110185412430689305'],
            ['30110193593719530879'],
            ['30109816670918989551'],
            ['30109719648288880847'],
            ['30109910413477557488'],
            ['30110937318259265586'],
            ['30110767435317009422'],
            ['30110693287544151268'],
            ['30110536903735789210'],
            ['30110837405893587071'],
            ['30109108086755776893'],
            ['30109127810412149594'],
            ['30109328287037054582'],
            ['30109762050023924930'],
            ['30110078491073540665'],
            ['30109399882513217891'],
            ['30110134857817177541'],
            ['30110588527221001719'],
            ['30109767790193355531'],
            ['30109475053382344098'],
            ['30110594407495048670'],
            ['30110472510090265976'],
            ['30109885431890603611'],
            ['30109696930592526610'],
            ['30110598829687291551'],
            ['30109917632777531622'],
            ['30109939748450517031'],
            ['30110594130278344491'],
            ['30110758043489401712'],
            ['30109202512257821341'],
            ['30109985661127180725'],
            ['30109897159778972360'],
            ['30110662278032452871'],
            ['30109480376957556293'],
            ['30110668065835724120'],
            ['30110184440080278566'],
            ['30109829846579183139'],
            ['30109325573738431905'],
            ['30110704771828173612'],
            ['30110222503576845872'],
            ['30110844011284354557'],
            ['30110704785227031789'],
            ['30109345576949376312'],
            ['30110064262902593459'],
            ['30109957254835673007'],
            ['30109924123735007259'],
            ['30109546449693445795'],
            ['30110766444691413873'],
            ['30110184289755519999'],
            ['30110930741533165418'],
            ['30110348085933115760'],
            ['30110505192658848991'],
            ['30109409625462709725'],
            ['30110827436758533458'],
            ['30110174599627891466'],
            ['30109950107321513824'],
            ['30109422155034465879'],
            ['30109575062837595472'],
            ['30109332814446898820'],
            ['30109208891796880488'],
            ['30109122887498520370'],
        ];
    }

    /**
     * @inheritDoc
     */
    protected function invalidDataProvider(): array
    {
        return [
            'INCORRECT_LENGTH' => ['3010962537306834309'],
            'STRING'           => ['ABCDEFGHIJ'],
            'CORRECT_BIK'      => ['004525987'],
            'CORRECT_INN'      => ['1927566091'],
            'CORRECT_SNILS'    => ['24769790639'],
            'CORRECT_OGRN'     => ['7053274436703'],
            'CORRECT_OGRNIP'   => ['415557944280841'],
        ];
    }

    /**
     * @return string[][]
     */
    private function validKsWithBikDataProvider(): array
    {
        return [
            ['30101810400000000225', '044525225'],
            ['30101810200000000593', '044525593'],
            ['30101810145250000411', '044525411'],
            ['30101810940300000832', '044030832'],
            ['30101810765770000545', '046577545'],
            ['30101810364010000818', '046401818'],
            ['30101T10364010000818', '046401818'],
            ['30101810850040000788', '045004788'],
            ['30101T10850040000788', '045004788'],
            ['30101810345250000677', '044525677'],
            ['30101810300000000202', '044525202'],
        ];
    }

    /**
     * @return string[][]
     */
    private function invalidKsWithBikDataProvider(): array
    {
        return [
            ['30101810400000000224', '044525225'],
            ['30101810200000000592', '044525593'],
            ['30101810200000000592', '044525592'],
            ['30101810200000002592', '044525592'],
            ['30101810200000010592', '044525592'],
            ['30101810200000000592', '044325592'],
            ['30101810200000000592', '044527592'],
            ['30101810850040010788', '045004777'],
            ['30101K10850040000788', '045004788'],
            ['30101810200000000592', ''],
            ['', ''],
            [null, 0],
        ];
    }
}
